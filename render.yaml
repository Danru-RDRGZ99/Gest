services:
  - type: pserv
    name: servicio-usuarios        # ← Debe coincidir exactamente con el nombre en Render
    runtime: docker
    rootDir: servicio_usuarios
    envVars:
      - key: PORT
        value: "10000"
      - key: DATABASE_URL
        value: "<INTERNAL_DB_URL>"
      - key: JWT_SECRET_KEY
        value: "<TU_SECRETO_JWT>"
    healthCheckPath: /health

  - type: pserv
    name: servicio-reservas
    runtime: docker
    rootDir: servicio_reservas
    envVars:
      - key: PORT
        value: "10000"
      - key: DATABASE_URL
        value: "<INTERNAL_DB_URL>"
      - key: JWT_SECRET_KEY
        value: "<TU_SECRETO_JWT>"
      - key: USER_SERVICE_URL
        fromService: { name: servicio-usuarios, type: pserv, property: hostport }
    healthCheckPath: /health

  - type: pserv
    name: servicio-inventario
    runtime: docker
    rootDir: servicio_inventario
    envVars:
      - key: PORT
        value: "10000"
      - key: DATABASE_URL
        value: "<INTERNAL_DB_URL>"
      - key: JWT_SECRET_KEY
        value: "<TU_SECRETO_JWT>"
      - key: USER_SERVICE_URL
        fromService: { name: servicio-usuarios, type: pserv, property: hostport }
      - key: RESERVA_SERVICE_URL
        fromService: { name: servicio-reservas, type: pserv, property: hostport }
    healthCheckPath: /health

  - type: web
    name: gateway-nginx
    runtime: docker
    rootDir: nginx
    healthCheckPath: /__health         # endpoint estático en Nginx
    envVars:
      - key: USUARIOS_HOSTPORT
        fromService: { name: servicio-usuarios, type: pserv, property: hostport }
      - key: RESERVAS_HOSTPORT
        fromService: { name: servicio-reservas, type: pserv, property: hostport }
      - key: INVENTARIO_HOSTPORT
        fromService: { name: servicio-inventario, type: pserv, property: hostport }
